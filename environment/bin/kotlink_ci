#!/usr/bin/env bash

function destroy_environment() {
	if [[ $? -gt 0 ]]; then
	    echo -e "\033[31mERROR\033[m: CI pipeline has failed!"
	fi
	./environment/lib/env_down ci
}

trap destroy_environment EXIT

./environment/lib/env_up ci
./gradlew clean check jacocoTestReport